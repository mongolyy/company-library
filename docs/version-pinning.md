# バージョン固定ポリシー

このドキュメントは、バージョンを固定すべきコアライブラリとそのルールを定義する。
依存関係の追加・更新を行う際は、必ずこのドキュメントを参照すること。

## バージョン固定対象ライブラリ

以下のライブラリは `^` や `~` を使わず、**固定バージョン（例: `"19.2.4"`）** で指定すること。

| ライブラリ | 固定する理由 |
|---|---|
| `next` | アプリケーションのフレームワーク本体。マイナーアップデートでも破壊的変更が含まれることがあるため、意図しないバージョン変更を防ぐ |
| `react` | Next.jsとの互換性が必要。Next.jsが要求するバージョンに合わせて明示的に管理する |
| `react-dom` | reactと同一バージョンで揃える必要がある |
| `@types/react` | reactのバージョンに対応する型定義を使用する必要がある |
| `@types/react-dom` | react-domのバージョンに対応する型定義を使用する必要がある |

## ルール

1. **上記のライブラリを更新する際は、`package.json` にキャレット（`^`）やチルダ（`~`）を付けない**
   - 正: `"react": "19.2.4"`
   - 誤: `"react": "^19.2.4"`
2. **react と react-dom は必ず同一バージョンに揃える**
3. **Next.js のアップグレード時は、そのバージョンが要求する react バージョンを確認してから更新する**
4. **`@types/react` と `@types/react-dom` は、対応する react バージョンのメジャー・マイナーに合わせる**
5. **yarn.lock の更新には必ず yarn を使用する（npm は使わない）**。npm を使うと yarn.lock のフォーマットが壊れ、CI の `yarn install --immutable` が失敗する
